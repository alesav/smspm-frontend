---
import type { CountryData } from "../../utils/kv-pricing";

export interface Props {
  country: CountryData;
  lang?: string;
}

const { country, lang: propLang } = Astro.props;
const { pathname } = Astro.url;

// Detect language from prop or path, default to 'en'
const langMatch = pathname.match(/^\/([a-z]{2})(\/|$)/);
const detectedFromPath = langMatch ? langMatch[1] : null;
const lang = (propLang || detectedFromPath || "en") as keyof typeof translations;

const startingPrice =
  country.providers.length > 0
    ? Math.min(...country.providers.map((p) => p.price))
    : 0;

const translations = {
  en: {
    home: "Home",
    countries: "Countries",
    directCarrier: "Direct carrier connections in",
    sendSmsTo: "Send SMS to",
    connectWith: "Connect with",
    mobileUsers: "mobile users through direct carrier connections. Experience",
    deliveryRates: "delivery rates with pricing from",
    perMessage: "per message.",
    startFreeTrial: "Start Free Trial",
    viewApiDocs: "View API Docs",
    deliveryRate: "Delivery Rate",
    responseTime: "Response Time",
    connected: "Connected",
    users: "Users",
    nationalNetwork: "National Network",
    liveSync: "Live Sync",
    directRouting: "Direct Routing",
    averageLatency: "Average latency",
    reliability: "Reliability",
  },
  et: {
    home: "Avaleht",
    countries: "Riigid",
    directCarrier: "Otsesed operaatori√ºhendused riigis",
    sendSmsTo: "Saada SMS",
    connectWith: "√úhenda",
    mobileUsers: "124 mobiili kasutajaga l√§bi otseste operaatori√ºhenduste. Koge",
    deliveryRates: "kohaletoimetamise m√§√§rasid hinnaga alates",
    perMessage: "s√µnumi kohta.",
    startFreeTrial: "Alusta tasuta prooviperioodi",
    viewApiDocs: "Vaata API dokumentatsiooni",
    deliveryRate: "Kohaletoimetamise m√§√§r",
    responseTime: "Vastamisaeg",
    connected: "√úhendatud",
    users: "Kasutajat",
    nationalNetwork: "Riiklik v√µrk",
    liveSync: "Reaalajas s√ºnkroniseerimine",
    directRouting: "Otsene marsruutimine",
    averageLatency: "Keskmine latentsus",
    reliability: "Usaldusv√§√§rsus",
  },
  ru: {
    home: "–ì–ª–∞–≤–Ω–∞—è",
    countries: "–°—Ç—Ä–∞–Ω—ã",
    directCarrier: "–ü—Ä—è–º—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ –≤",
    sendSmsTo: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å SMS –≤",
    connectWith: "–°–≤—è–∂–∏—Ç–µ—Å—å —Å",
    mobileUsers: "–º–æ–±–∏–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ –ø—Ä—è–º—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏. –ò—Å–ø—ã—Ç–∞–π—Ç–µ",
    deliveryRates: "–ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å —Ü–µ–Ω–æ–π –æ—Ç",
    perMessage: "–∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ.",
    startFreeTrial: "–ù–∞—á–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥",
    viewApiDocs: "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API",
    deliveryRate: "–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –¥–æ—Å—Ç–∞–≤–∫–∏",
    responseTime: "–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞",
    connected: "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ",
    users: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
    nationalNetwork: "–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–µ—Ç—å",
    liveSync: "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏",
    directRouting: "–ü—Ä—è–º–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è",
    averageLatency: "–°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞",
    reliability: "–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å",
  },
  es: {
    home: "Inicio",
    countries: "Pa√≠ses",
    directCarrier: "Conexiones directas con operadores en",
    sendSmsTo: "Enviar SMS a",
    connectWith: "Conecta con",
    mobileUsers: "usuarios m√≥viles a trav√©s de conexiones directas con operadores. Experimenta",
    deliveryRates: "tasas de entrega con precios desde",
    perMessage: "por mensaje.",
    startFreeTrial: "Iniciar prueba gratuita",
    viewApiDocs: "Ver documentaci√≥n API",
    deliveryRate: "Tasa de entrega",
    responseTime: "Tiempo de respuesta",
    connected: "Conectado",
    users: "Usuarios",
    nationalNetwork: "Red nacional",
    liveSync: "Sincronizaci√≥n en vivo",
    directRouting: "Enrutamiento directo",
    averageLatency: "Latencia promedio",
    reliability: "Fiabilidad",
  },
  de: {
    home: "Startseite",
    countries: "L√§nder",
    directCarrier: "Direkte Anbieterverbindungen in",
    sendSmsTo: "SMS senden an",
    connectWith: "Verbinden Sie sich mit",
    mobileUsers: "mobilen Nutzern √ºber direkte Anbieterverbindungen. Erleben Sie",
    deliveryRates: "Zustellraten mit Preisen ab",
    perMessage: "pro Nachricht.",
    startFreeTrial: "Kostenlose Testversion starten",
    viewApiDocs: "API-Dokumentation ansehen",
    deliveryRate: "Zustellrate",
    responseTime: "Antwortzeit",
    connected: "Verbunden",
    users: "Benutzer",
    nationalNetwork: "Nationales Netzwerk",
    liveSync: "Live-Synchronisierung",
    directRouting: "Direktes Routing",
    averageLatency: "Durchschnittliche Latenz",
    reliability: "Zuverl√§ssigkeit",
  },
  fr: {
    home: "Accueil",
    countries: "Pays",
    directCarrier: "Connexions directes avec les op√©rateurs en",
    sendSmsTo: "Envoyer SMS vers",
    connectWith: "Connectez-vous avec",
    mobileUsers: "utilisateurs mobiles via des connexions directes avec les op√©rateurs. D√©couvrez",
    deliveryRates: "taux de livraison avec des prix √† partir de",
    perMessage: "par message.",
    startFreeTrial: "Commencer l'essai gratuit",
    viewApiDocs: "Voir la documentation API",
    deliveryRate: "Taux de livraison",
    responseTime: "Temps de r√©ponse",
    connected: "Connect√©",
    users: "Utilisateurs",
    nationalNetwork: "R√©seau national",
    liveSync: "Synchronisation en direct",
    directRouting: "Routage direct",
    averageLatency: "Latence moyenne",
    reliability: "Fiabilit√©",
  },
  lv: {
    home: "SƒÅkums",
    countries: "Valstis",
    directCarrier: "Tie≈°ie operatoru savienojumi",
    sendSmsTo: "S≈´tƒ´t SMS uz",
    connectWith: "Savienojieties ar",
    mobileUsers: "mobilajiem lietotƒÅjiem, izmantojot tie≈°os operatoru savienojumus. Piedzƒ´vojiet",
    deliveryRates: "piegƒÅdes rƒÅdƒ´tƒÅjus ar cenƒÅm no",
    perMessage: "par zi≈Üojumu.",
    startFreeTrial: "SƒÅkt bezmaksas izmƒìƒ£inƒÅjumu",
    viewApiDocs: "Skatƒ´t API dokumentƒÅciju",
    deliveryRate: "PiegƒÅdes rƒÅdƒ´tƒÅjs",
    responseTime: "Atbildes laiks",
    connected: "Savienots",
    users: "LietotƒÅji",
    nationalNetwork: "NacionƒÅlais tƒ´kls",
    liveSync: "Tie≈°raides sinhronizƒÅcija",
    directRouting: "Tie≈°ais mar≈°rutƒì≈°ana",
    averageLatency: "VidƒìjƒÅ latentums",
    reliability: "Uzticamƒ´ba",
  },
  lt: {
    home: "Pagrindinis",
    countries: "≈†alys",
    directCarrier: "Tiesioginiai operatori≈≥ ry≈°iai",
    sendSmsTo: "Si≈≥sti SMS ƒØ",
    connectWith: "Prisijunkite su",
    mobileUsers: "mobili≈≥ vartotoj≈≥ per tiesioginius operatori≈≥ ry≈°ius. Patirkite",
    deliveryRates: "pristatymo rodiklius su kainomis nuo",
    perMessage: "u≈æ prane≈°imƒÖ.",
    startFreeTrial: "Pradƒóti nemokamƒÖ bandomƒÖjƒØ",
    viewApiDocs: "≈Ωi≈´rƒóti API dokumentacijƒÖ",
    deliveryRate: "Pristatymo rodiklis",
    responseTime: "Atsakymo laikas",
    connected: "Prijungta",
    users: "Vartotojai",
    nationalNetwork: "Nacionalinis tinklas",
    liveSync: "Tiesioginis sinchronizavimas",
    directRouting: "Tiesioginis mar≈°rutizavimas",
    averageLatency: "Vidutinis vƒólavimas",
    reliability: "Patikimumas",
  },
};

const t = translations[lang] || translations.en;
---

<!-- Hero Section -->
<section class="hero relative pt-[140px] pb-20 overflow-hidden">
  <div class="hero-gradient-bg absolute top-0 left-0 right-0 bottom-0 -z-10">
  </div>

  <div class="container mx-auto px-8">
    <div
      class="hero-content grid grid-cols-1 lg:grid-cols-5 gap-12 items-center"
    >
      <div class="hero-text lg:col-span-3">
        <!-- Breadcrumbs -->
        <nav class="flex mb-8 text-sm" aria-label="Breadcrumb">
          <ol class="flex items-center space-x-2 text-dynamic-tertiary">
            <li>
              <a href={`/${lang}`} class="hover:text-cyan transition-colors">{t.home}</a>
            </li>
            <li>
              <svg
                width="12"
                height="12"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  d="M7 3L15 10L7 17"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"></path>
              </svg>
            </li>
            <li>
              <a href={`/${lang}/countries`} class="hover:text-cyan transition-colors"
                >{t.countries}</a
              >
            </li>
            <li>
              <svg
                width="12"
                height="12"
                viewBox="0 0 20 20"
                fill="currentColor"
              >
                <path
                  d="M7 3L15 10L7 17"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"></path>
              </svg>
            </li>
            <li class="text-cyan font-medium" aria-current="page">
              {country.name}
            </li>
          </ol>
        </nav>

        <div
          class="hero-badge inline-flex items-center gap-2 px-6 py-2 bg-cyan/10 border border-cyan/30 rounded-full text-sm text-cyan font-medium mb-8"
        >
          <span
            class="badge-dot w-2 h-2 bg-gradient-1 rounded-full animate-pulse-slow"
          ></span>
          {t.directCarrier} {country.name}
        </div>

        <h1
          class="hero-title text-4xl lg:text-6xl font-extrabold leading-tight mb-6 tracking-tight text-dynamic-primary"
        >
          {t.sendSmsTo}
          <span class="gradient-text block">{country.name}</span>
        </h1>

        <p
          class="hero-subtitle text-xl text-dynamic-secondary leading-relaxed mb-8 max-w-[640px]"
        >
          {t.connectWith} <span class="gradient-text">{country.mobileUsers}</span> {t.mobileUsers}
          <span
            class="gradient-text"
            >{country.stats.deliveryRate} {t.deliveryRates}</span
          >
          <span class="gradient-text"
            >{
              country.currency === "EUR"
                ? "‚Ç¨"
                : country.currency === "GBP"
                  ? "¬£"
                  : "$"
            }{startingPrice.toFixed(3)}</span
          > {t.perMessage}
        </p>

        <div class="hero-actions flex flex-col sm:flex-row gap-4 mb-8">
          <a
            href="https://app.smspm.com/app/register"
            class="btn btn-primary btn-large"
          >
            {t.startFreeTrial}
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path
                d="M7 3L15 10L7 17"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"></path>
            </svg>
          </a>
          <a
            href="https://app.smspm.com/docs"
            class="btn btn-secondary btn-large"
          >
            {t.viewApiDocs}
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path
                d="M3 7H21L19 12L21 17H3L5 12L3 7Z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"></path>
            </svg>
          </a>
        </div>

        <div class="hero-stats flex flex-wrap gap-12">
          <div class="stat-item">
            <div
              class="stat-value text-3xl lg:text-5xl font-extrabold gradient-text"
            >
              {country.stats.deliveryRate}
            </div>
            <div
              class="stat-label text-sm text-dynamic-tertiary uppercase tracking-wider mt-1"
            >
              {t.deliveryRate}
            </div>
          </div>
          <div class="stat-item">
            <div
              class="stat-value text-3xl lg:text-5xl font-extrabold gradient-text"
            >
              {country.stats.responseTime}
            </div>
            <div
              class="stat-label text-sm text-dynamic-tertiary uppercase tracking-wider mt-1"
            >
              {t.responseTime}
            </div>
          </div>
        </div>
      </div>

      <div
        class="hero-visual relative h-[600px] lg:col-span-2 hidden lg:flex items-center justify-center"
      >
        <!-- Premium Flag Orb Portal -->
        <div
          class="flag-orb-container relative w-full h-full flex items-center justify-center"
        >
          <!-- Enhanced Halo/Rings -->
          <div
            class="absolute w-[380px] h-[380px] border-2 border-cyan/20 rounded-full animate-pulse-slow shadow-[0_0_30px_rgba(38,198,218,0.1)]"
          >
          </div>
          <div
            class="absolute w-[480px] h-[480px] border border-cyan/10 rounded-full animate-float shadow-[0_0_50px_rgba(38,198,218,0.05)]"
            style="animation-duration: 10s;"
          >
          </div>
          <div
            class="absolute w-[320px] h-[320px] bg-cyan/5 rounded-full blur-3xl z-0"
          >
          </div>

          <!-- The Orb -->
          <div
            class="relative w-80 h-80 rounded-full overflow-hidden shadow-[0_0_80px_rgba(38,198,218,0.3)] border-2 border-white/20 z-10 transition-transform duration-700 hover:scale-105"
          >
            <img
              src={`https://hatscripts.github.io/circle-flags/flags/${country.code.toLowerCase()}.svg`}
              alt={`${country.name} Flag`}
              class="w-full h-full object-cover scale-110"
              loading="lazy"
            />
            <!-- Glass Overlay -->
            <div
              class="absolute inset-0 bg-gradient-to-tr from-white/10 via-transparent to-black/10"
            >
            </div>
          </div>

          <!-- Floating Info Cards Staggered in Depth -->
          <div
            class="floating-card absolute top-12 -left-4 w-[200px] bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl border border-white/20 rounded-2xl p-4 shadow-[0_20px_50px_rgba(0,0,0,0.1)] z-20 animate-float"
          >
            <div class="card-header flex justify-between items-center mb-3">
              <div class="flex items-center gap-2">
                <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"
                ></span>
                <span
                  class="text-[10px] font-bold uppercase tracking-widest text-green-500"
                  >{t.connected}</span
                >
              </div>
              <span class="card-icon text-lg">üì±</span>
            </div>
            <p class="text-[15px] font-bold text-dynamic-primary">
              {country.mobileUsers} {t.users}
            </p>
            <p
              class="text-[10px] text-dynamic-tertiary uppercase tracking-tight"
            >
              {country.name} {t.nationalNetwork}
            </p>
          </div>

          <div
            class="floating-card absolute bottom-12 -right-4 w-[220px] bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl border border-white/20 rounded-2xl p-4 shadow-[0_20px_50px_rgba(0,0,0,0.1)] z-20 animate-float"
            style="animation-delay: 2s;"
          >
            <div class="card-header flex justify-between items-center mb-3">
              <div class="flex items-center gap-2">
                <span class="w-2 h-2 bg-cyan rounded-full animate-pulse"></span>
                <span
                  class="text-[10px] font-bold uppercase tracking-widest text-cyan"
                  >{t.liveSync}</span
                >
              </div>
              <span class="card-icon text-lg">‚ö°</span>
            </div>
            <p class="text-[15px] font-bold text-dynamic-primary">
              {t.directRouting}
            </p>
            <p
              class="text-[10px] text-dynamic-tertiary uppercase tracking-tight"
            >
              {country.stats.responseTime} {t.averageLatency}
            </p>
          </div>

          <div
            class="floating-card absolute top-1/2 -right-8 transform -translate-y-1/2 w-[140px] bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl border border-white/20 rounded-2xl p-4 shadow-[0_20px_50px_rgba(0,0,0,0.1)] z-20 animate-float"
            style="animation-delay: 4s;"
          >
            <div class="chart-header flex justify-between items-center mb-3">
              <span
                class="text-[10px] font-bold uppercase tracking-widest text-dynamic-tertiary"
                >{t.reliability}</span
              >
            </div>
            <div class="chart-bars flex items-end gap-1.5 h-[40px]">
              <div class="flex-1 rounded-sm bg-cyan/20" style="height: 40%;">
              </div>
              <div class="flex-1 rounded-sm bg-cyan/40" style="height: 60%;">
              </div>
              <div class="flex-1 rounded-sm bg-cyan/60" style="height: 50%;">
              </div>
              <div class="flex-1 rounded-sm bg-cyan" style="height: 90%;"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .hero-gradient-bg {
    background:
      radial-gradient(
        circle at 15% 15%,
        rgba(38, 198, 218, 0.1) 0%,
        transparent 40%
      ),
      radial-gradient(
        circle at 85% 85%,
        rgba(13, 71, 161, 0.1) 0%,
        transparent 40%
      );
  }

  [data-theme="dark"] .hero-gradient-bg {
    background:
      radial-gradient(
        circle at 15% 15%,
        rgba(38, 198, 218, 0.2) 0%,
        transparent 40%
      ),
      radial-gradient(
        circle at 85% 85%,
        rgba(13, 71, 161, 0.2) 0%,
        transparent 40%
      );
  }

  .animate-float {
    animation: float 6s ease-in-out infinite;
  }

  @keyframes float {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-20px);
    }
  }

  .gradient-text {
    background: linear-gradient(135deg, #26c6da 0%, #0d47a1 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
</style>
