---
import type { CountryData } from "../../utils/kv-pricing";

export interface Props {
  country: CountryData;
  lang?: string;
}

const { country, lang: propLang } = Astro.props;
const { pathname } = Astro.url;

const langMatch = pathname.match(/^\/([a-z]{2})(\/|$)/);
const detectedFromPath = langMatch ? langMatch[1] : null;
const lang = (propLang || detectedFromPath || "en") as keyof typeof translations;

const translations = {
  en: {
    badge: "Market Overview",
    title: "Mobile Market in",
    subtitle: "Understanding the local mobile landscape for",
    effectiveCampaigns: "effective SMS campaigns",
    population: "Population",
    penetration: "Penetration",
    countryCode: "Country Code",
    timezone: "Timezone",
  },
  et: {
    badge: "Turu ülevaade",
    title: "Mobiiliturg riigis",
    subtitle: "Kohaliku mobiilse maastiku mõistmine",
    effectiveCampaigns: "tõhusate SMS-kampaaniate jaoks",
    population: "Rahvastik",
    penetration: "Levik",
    countryCode: "Riigi kood",
    timezone: "Ajavöönd",
  },
  ru: {
    badge: "Обзор рынка",
    title: "Мобильный рынок в",
    subtitle: "Понимание местного мобильного ландшафта для",
    effectiveCampaigns: "эффективных SMS-кампаний",
    population: "Население",
    penetration: "Проникновение",
    countryCode: "Код страны",
    timezone: "Часовой пояс",
  },
  es: {
    badge: "Visión del Mercado",
    title: "Mercado Móvil en",
    subtitle: "Comprendiendo el panorama móvil local para",
    effectiveCampaigns: "campañas SMS efectivas",
    population: "Población",
    penetration: "Penetración",
    countryCode: "Código de País",
    timezone: "Zona Horaria",
  },
  de: {
    badge: "Marktübersicht",
    title: "Mobilfunkmarkt in",
    subtitle: "Verständnis der lokalen Mobilfunklandschaft für",
    effectiveCampaigns: "effektive SMS-Kampagnen",
    population: "Bevölkerung",
    penetration: "Durchdringung",
    countryCode: "Ländercode",
    timezone: "Zeitzone",
  },
  fr: {
    badge: "Aperçu du Marché",
    title: "Marché Mobile en",
    subtitle: "Comprendre le paysage mobile local pour",
    effectiveCampaigns: "des campagnes SMS efficaces",
    population: "Population",
    penetration: "Pénétration",
    countryCode: "Code Pays",
    timezone: "Fuseau Horaire",
  },
  lv: {
    badge: "Tirgus pārskats",
    title: "Mobilo sakaru tirgus",
    subtitle: "Vietējā mobilā ainavas izpratne",
    effectiveCampaigns: "efektīvām SMS kampaņām",
    population: "Iedzīvotāji",
    penetration: "Izplatība",
    countryCode: "Valsts kods",
    timezone: "Laika josla",
  },
  lt: {
    badge: "Rinkos apžvalga",
    title: "Mobilusis rinkoje",
    subtitle: "Vietinės mobiliosios aplinkos supratimas",
    effectiveCampaigns: "veiksmingoms SMS kampanijoms",
    population: "Gyventojai",
    penetration: "Skvarba",
    countryCode: "Šalies kodas",
    timezone: "Laiko juosta",
  },
};

const t = translations[lang] || translations.en;
---

<!-- Country Info Section -->
<section class="country-info py-16 lg:py-24">
  <div class="container mx-auto px-8">
    <div class="text-center mb-16">
      <span
        class="section-badge inline-flex px-6 py-2 bg-cyan/10 border border-cyan/30 rounded-full text-sm text-cyan font-semibold mb-6"
        >{t.badge}</span
      >
      <h2 class="text-3xl lg:text-5xl font-extrabold mb-4 text-dynamic-primary">
        {t.title} <span class="gradient-text">{country.nameLoc || country.namePrep || country.name}</span>
      </h2>
      <p class="text-lg text-dynamic-secondary max-w-2xl mx-auto">
        {t.subtitle} <span class="gradient-text"
          >{t.effectiveCampaigns}</span
        >
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16">
      <div
        class="info-card bg-dynamic-primary border border-dynamic-primary rounded-xl p-8 text-center hover:shadow-2xl transition-all duration-500 hover:-translate-y-2"
      >
        <div
          class="w-14 h-14 bg-cyan/10 rounded-lg mx-auto mb-6 flex items-center justify-center text-cyan"
        >
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
        </div>
        <h3 class="text-3xl font-extrabold text-dynamic-primary mb-2">
          {country.population}
        </h3>
        <p class="text-sm uppercase tracking-widest text-dynamic-tertiary">
          {t.population}
        </p>
      </div>

      <div
        class="info-card bg-dynamic-primary border border-dynamic-primary rounded-xl p-8 text-center hover:shadow-2xl transition-all duration-500 hover:-translate-y-2"
      >
        <div
          class="w-14 h-14 bg-cyan/10 rounded-lg mx-auto mb-6 flex items-center justify-center text-cyan"
        >
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect>
            <line x1="12" y1="18" x2="12.01" y2="18"></line>
          </svg>
        </div>
        <h3 class="text-3xl font-extrabold text-dynamic-primary mb-2">
          {country.mobilePenetration}
        </h3>
        <p class="text-sm uppercase tracking-widest text-dynamic-tertiary">
          {t.penetration}
        </p>
      </div>

      <div
        class="info-card bg-dynamic-primary border border-dynamic-primary rounded-xl p-8 text-center hover:shadow-2xl transition-all duration-500 hover:-translate-y-2"
      >
        <div
          class="w-14 h-14 bg-cyan/10 rounded-lg mx-auto mb-6 flex items-center justify-center text-cyan"
        >
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path
              d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"
            ></path>
          </svg>
        </div>
        <h3 class="text-3xl font-extrabold text-dynamic-primary mb-2">
          {country.callingCode}
        </h3>
        <p class="text-sm uppercase tracking-widest text-dynamic-tertiary">
          {t.countryCode}
        </p>
      </div>

      <div
        class="info-card bg-dynamic-primary border border-dynamic-primary rounded-xl p-8 text-center hover:shadow-2xl transition-all duration-500 hover:-translate-y-2"
      >
        <div
          class="w-14 h-14 bg-cyan/10 rounded-lg mx-auto mb-6 flex items-center justify-center text-cyan"
        >
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
        </div>
        <h3
          class="text-lg font-extrabold text-dynamic-primary mb-2 line-clamp-1"
        >
          {country.timezone.split(" (")[0]}
        </h3>
        <p class="text-sm uppercase tracking-widest text-dynamic-tertiary">
          {t.timezone}
        </p>
      </div>
    </div>

    <div class="max-w-4xl mx-auto text-center">
      <div class="bg-dynamic-secondary rounded-2xl p-8 lg:p-12">
        <p class="text-lg text-dynamic-secondary leading-relaxed">
          {country.marketDescription}
        </p>
      </div>
    </div>
  </div>
</section>

<style>
  .gradient-text {
    background: linear-gradient(135deg, #26c6da 0%, #0d47a1 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
</style>
